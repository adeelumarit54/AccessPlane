!function(){var e;function o(o){var t=o.asyncContext,n=o.value;e.to.getAsync({},(function(o){if(o.status===Office.AsyncResultStatus.Succeeded){o.value.map((function(e){return e.emailAddress}));var c=window.localStorage.getItem("access_token"),a=window.localStorage.getItem("communicationUser"),i=JSON.parse(a);console.log("Access Token:",c),console.log("Communication User:",i),e.subject.getAsync((function(e){if(e.status===Office.AsyncResultStatus.Succeeded){var o=e.value;console.log("Subject:",o);var a=new Headers;a.append("Content-Type","application/json"),a.append("Authorization","Bearer "+c);var s=JSON.stringify({MappedIDType:"User",MappedID:i.ID,CommunicationTypeID:"-1",Subject:o||"No subject",Body:n});fetch("https://outlookdemo.accessplanit.com/accessplansandbox/api/v2/communication",{method:"POST",headers:a,body:s}).then((function(e){return e.json()})).then((function(e){console.log("API call succeeded:",e),t.completed({allowEvent:!0})})).catch((function(e){console.error("API call failed:",e),t.completed({allowEvent:!1})}))}else console.error("Failed to get subject."),t.completed({allowEvent:!1})}))}else console.error("Failed to get recipients."),t.completed({allowEvent:!1})}))}Office.onReady((function(){e=Office.context.mailbox.item})),Office.actions.associate("action",(function(e){var o,t={type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:"Performed action.",icon:"Icon.80x80",persistent:!0};null===(o=Office.context.mailbox.item)||void 0===o||o.notificationMessages.replaceAsync("ActionPerformanceNotification",t),e.completed()})),Office.actions.associate("validateBody",(function(t){e.body.getAsync("text",{asyncContext:t},o)}))}();
//# sourceMappingURL=commands.js.map